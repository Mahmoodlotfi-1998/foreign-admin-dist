import{d as h,o as v,aa as R,aG as J,aj as K,p as a,ao as I,b as n,j as D,w as s,a as p,a7 as g,c as C,a5 as F,ay as Q,u as w,am as T,az as k,a9 as X,z as Z,aB as ee,aH as te,k as oe}from"./index-C59nPxhS.js";import{_ as re}from"./UserField.vue_vue_type_script_setup_true_lang-CQM04a8h.js";import{T as ae,u as se,b as q}from"./confirmModal-BHHX47cc.js";import{r as ne}from"./useDataTime-Bw-ruvr2.js";import{_ as le}from"./BasicInput.vue_vue_type_style_index_0_lang-aq0GGqLW.js";import{i as S}from"./inputRules-xjkY4-Lc.js";import{_ as ie,F as ue}from"./index-hdx7AmHB.js";import{B as de}from"./BasicMainCard-DYu65gub.js";import"./usePrice-yLsZ7WwN.js";import"./Col-BSSjyXRi.js";import"./useSize-Bw3G1olW.js";const ce=h({__name:"CustomTag",props:{textColor:{},bgColor:{}},setup(e){const t=e;return(i,d)=>(v(),R("div",{style:K({color:t.textColor,backgroundColor:t.bgColor}),class:"w-fit p-1 rounded-lg"},[J(i.$slots,"default")],4))}}),_e=[{title:"Rows",dataIndex:"id",key:"id",filterable:!1,sortable:!1,width:100,customRender:e=>e.index+1},{title:"Owner Name",dataIndex:"borrowers.owner_name_formatted",key:"borrowers.owner_name_formatted",type:"Text",width:140},{title:"Date and time",dataIndex:"created_at",key:"created_at",type:"DateTime",width:130,customRender(e){return ne(e.record.created_at)}},{title:"Status",dataIndex:"requested_at",key:"requested_at",type:"Text",width:120,customRender(e){var t,i;return a("div",{class:"flex justify-center"},[a(ce,{textColor:j((t=e.record)==null?void 0:t.status).textColor,bgColor:j((i=e.record)==null?void 0:i.status).bgColor},{default:()=>{var d;return[(d=e.record)==null?void 0:d.status]}})])}},{title:"Pricing(%)",dataIndex:"pricing_details",key:"pricing_details",type:"Number",width:140,customRender(e){return e.record.pricing_details??"_"}},{title:"income($)",dataIndex:"income",key:"income",type:"Number",width:140,customRender(e){return e.record.income??"_"}},{title:"Current LTV Above 50",dataIndex:"borrowers.current_ltv_above_50",key:"borrowers.current_ltv_above_50",type:"Text",width:120,customRender(e){var t,i;return(i=(t=e.record)==null?void 0:t.borrowers)!=null&&i.current_ltv_above_50?"Yes":"No"}},{title:"SR Date Above And FMLA",dataIndex:"borrowers.sr_date_above_and_fmla",key:"borrowers.sr_date_above_and_fmla",type:"Boolean",width:140,customRender(e){var t;return(t=e.record.borrowers)!=null&&t.sr_date_above_and_fmla?"Yes":"No"}},{title:"Owner Occupied Residential No",dataIndex:"borrowers.owner_occupied_residential_no",key:"borrowers.owner_occupied_residential_no",type:"Boolean",width:150,customRender(e){var t;return(t=e.record.borrowers)!=null&&t.owner_occupied_residential_no?"Yes":"No"}},{title:"Current Tax Year Above 20000",dataIndex:"borrowers.current_tax_year_above20000",key:"borrowers.current_tax_year_above20000",type:"Boolean",width:140,customRender(e){var t;return(t=e.record.borrowers)!=null&&t.current_tax_year_above20000?"Yes":"No"}},{title:"FMLA Above 1 And SMLA Above 1",dataIndex:"borrowers.fmla_above1_and_smla_above1",key:"borrowers.fmla_above1_and_smla_above1",type:"Boolean",width:160,customRender(e){var t;return(t=e.record.borrowers)!=null&&t.fmla_above1_and_smla_above1?"Yes":"No"}},{title:"Age Above 55",dataIndex:"borrowers.age_above_55",key:"borrowers.age_above_55",type:"Boolean",width:120,customRender(e){var t;return(t=e.record.borrowers)!=null&&t.age_above_55?"Yes":"No"}},{title:"First Mortgage Interest Rate Above 65",dataIndex:"borrowers.first_mortgage_interest_rate_above_65",key:"borrowers.first_mortgage_interest_rate_above_65",type:"Boolean",width:180,customRender(e){var t;return(t=e.record.borrowers)!=null&&t.first_mortgage_interest_rate_above_65?"Yes":"No"}},{title:"Current LTV Above 80",dataIndex:"borrowers.current_ltv_above_80",key:"borrowers.current_ltv_above_80",type:"Boolean",width:120,customRender(e){var t;return(t=e.record.borrowers)!=null&&t.current_ltv_above_80?"Yes":"No"}},{title:"options",dataIndex:"action",key:"action",slot:"action",fixed:"right",width:120,filterable:!1}],j=e=>{switch(e){case"open":return{textColor:"#FFA000",bgColor:"#FFF3CD"};case"suggested":return{textColor:"#0066FF",bgColor:"#E8F0FF"};case"accepted":return{textColor:"#1E7F4C",bgColor:"#DFF3E5"};case"rejected":return{textColor:"#D32F2F",bgColor:"#FFEBEE"};case"finished":return{textColor:"#4cafaf",bgColor:"#e8f5f4"};case"cancelled":return{textColor:"#9E9E9E",bgColor:"#F5F5F5"};default:return{textColor:"#000",bgColor:"#FFF"}}},me=async(e,t)=>I.fetch("pricing_requests","update",{data:t,field:"id",value:e}),fe=async e=>I.fetch("pricing_requests","update",{data:{status:"rejected"},field:"id",value:e}),pe=async e=>I.fetch("pricing_requests","update",{data:{status:"finished"},field:"id",value:e}),be={class:"gap-2 flex justify-center"},ve={class:"grid md:grid-cols-1 gap-4"},ge=h({__name:"table",props:{mobile:{}},emits:["delete","edit","add","info"],setup(e,{expose:t,emit:i}){const[d,c]=se(),_=n([]),b=n(),m=n({expiration_at:"",pricing_details:"",status:"suggested"}),A=n();let B;function Y(r){B=r,b.value=!0,m.value={expiration_at:"",pricing_details:"",status:"suggested"}}async function V(){var r;(r=A.value)==null||r.validateFields().then(async()=>{try{k.value=!0,await me(B,m.value),c(),b.value=!1}catch(o){console.log(o)}finally{k.value=!1}})}function M(r){q("Are you sure to reject this request?",r??"",fe,c)}function P(r){q("Are you sure to finish this request?",r??"",pe,c)}n(null);const $=n(),y=n(!1);let E=!1;const L=n({columns:_e,api:r=>(E&&(r.filters=[],_.value.forEach(o=>{var f;(f=r.filters)==null||f.push({field:`borrowers.${o}`,type:"switch",value:!0,cr:"and",op:"eq",hidden:!0})})),r.select=["*","borrowers (*)"],ae(r,"pricing_requests"))}),O=()=>{c()};function U(r){console.log(r),$.value=X.cloneDeep(r),y.value=!0}return D(_,r=>{E=!0,c()}),t({fetch:O}),(r,o)=>{const f=Z,z=ee,G=re,N=ie,H=te,W=ue;return v(),R("div",null,[a(z,Q(L.value,{onRegister:w(d),ref:"tbl"}),{extraHeader:s(()=>o[6]||(o[6]=[])),action:s(({column:u,record:l})=>[p("div",be,[a(f,{placement:"bottom",class:"cursor-pointer",onClick:x=>U(l.borrowers)},{title:s(()=>o[7]||(o[7]=[p("span",null,"Info",-1)])),default:s(()=>[a(g,{icon:"vuesax-linear:personalcard",color:"#10913A"})]),_:2},1032,["onClick"]),l.status==="open"?(v(),C(f,{key:0,placement:"bottom",class:"cursor-pointer",onClick:x=>Y(l==null?void 0:l.id)},{title:s(()=>o[8]||(o[8]=[p("span",null,"Suggest",-1)])),default:s(()=>[a(g,{icon:"vuesax-linear:clipboard-text",color:"#0066FF"})]),_:2},1032,["onClick"])):F("",!0),l.status==="open"||l.status==="accepted"||l.status==="suggested"?(v(),C(f,{key:1,placement:"bottom",class:"cursor-pointer",onClick:x=>M(l.id)},{title:s(()=>o[9]||(o[9]=[p("span",null,"Reject",-1)])),default:s(()=>[a(g,{icon:"vuesax-linear:clipboard-close",color:"#D32F2F"})]),_:2},1032,["onClick"])):F("",!0),l.status==="accepted"?(v(),C(f,{key:2,placement:"bottom",class:"cursor-pointer",onClick:x=>P(l.id)},{title:s(()=>o[10]||(o[10]=[p("span",null,"Finish",-1)])),default:s(()=>[a(g,{icon:"vuesax-linear:medal-star",color:"#4CAF50"})]),_:2},1032,["onClick"])):F("",!0)])]),_:1},16,["onRegister"]),a(T,{visible:y.value,width:"70rem",height:"90rem",title:"Borrower details","custom-footer":!0,onClose:o[0]||(o[0]=u=>y.value=!1),destroyOnClose:!0},{default:s(()=>[a(G,{"user-form":$.value},null,8,["user-form"])]),_:1},8,["visible"]),a(T,{visible:b.value,"onUpdate:visible":o[3]||(o[3]=u=>b.value=u),width:"20rem",title:"Suggest",onOk:o[4]||(o[4]=u=>V()),loading:w(k),onClose:o[5]||(o[5]=u=>b.value=!1)},{default:s(()=>[a(W,{model:m.value,ref_key:"suggestFormRef",ref:A,autocomplete:"off"},{default:s(()=>[p("div",ve,[a(N,{label:"Percent",name:"pricing_details",rules:w(S)()},{default:s(()=>[a(le,{value:m.value.pricing_details,"onUpdate:value":o[1]||(o[1]=u=>m.value.pricing_details=u),type:"number","addon-after":"%"},null,8,["value"])]),_:1},8,["rules"]),a(N,{label:"Expire at",name:"expiration_at",rules:w(S)()},{default:s(()=>[a(H,{"show-time":"",value:m.value.expiration_at,"onUpdate:value":o[2]||(o[2]=u=>m.value.expiration_at=u)},null,8,["value"])]),_:1},8,["rules"])])]),_:1},8,["model"])]),_:1},8,["visible","loading"])])}}}),we={class:"flex w-full h-full"},Ee=h({__name:"index",setup(e){const t=n(!1);n([]),oe(()=>i());async function i(){try{t.value=!0}catch(_){console.log(_)}finally{t.value=!1}}const d=n(null);n(null),n(0);const c=n({borrower_ids:[],message:"",type_offer:void 0,send_username_login:!1});return n(),D(c.value.borrower_ids,_=>{console.log(_)}),n(!1),(_,b)=>(v(),R("div",null,[a(de,null,{default:s(()=>[p("div",we,[a(ge,{ref_key:"table",ref:d,class:"w-full h-full"},null,512)])]),_:1})]))}});export{Ee as default};
