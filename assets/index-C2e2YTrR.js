import{ao as U,d as S,b as i,r as z,o as N,aa as B,p as o,w as s,ay as O,u as b,c as Y,a as y,a5 as j,a7 as A,aq as G,aB as F,a9 as $,j as D,z as H,am as K,F as J,an as M,at as Q}from"./index-C59nPxhS.js";import{T as q,u as L,c as W}from"./confirmModal-BHHX47cc.js";import{r as X}from"./useDataTime-Bw-ruvr2.js";import{u as E}from"./usePrice-yLsZ7WwN.js";import{_ as P,d as Z}from"./BasicSelect.vue_vue_type_style_index_0_lang-Cpt2e2tb.js";import{_ as V,F as ee}from"./index-hdx7AmHB.js";import{B as te}from"./BasicMainCard-DYu65gub.js";import{_ as ae}from"./BasicTextArea.vue_vue_type_style_index_0_lang-DaM2e8TG.js";import{i as I}from"./inputRules-xjkY4-Lc.js";import"./Col-BSSjyXRi.js";import"./useSize-Bw3G1olW.js";const oe=async l=>U.fetch("pre_applications","insert",{data:l}),le=[{title:"Rows",dataIndex:"id",key:"id",filterable:!1,sortable:!1,width:100,customRender:l=>l.index+1},{title:"Type offer",dataIndex:"type_offer",key:"type_offer",type:"Number",width:100},{title:"Date and time",dataIndex:"created_at",key:"created_at",type:"DateTime",width:200,customRender(l){return X(l.record.created_at)}},{title:"Text",dataIndex:"message",key:"message",type:"Number"}],ne=S({__name:"table",props:{mobile:{}},emits:["delete","edit","add","info"],setup(l,{expose:t,emit:x}){const[f,g]=L(),p=x;i(null);const h=i({columns:le,api:m=>q(m,"pre_applications")});return t({fetch:()=>{g()}}),(m,n)=>{const v=A,c=G,R=F,C=z("BasicShowContext");return N(),B("div",null,[o(C,{title:"Offers list"},{default:s(()=>[o(R,O(b(h),{onRegister:b(f),ref:"tbl"}),{extraHeader:s(()=>[m.mobile?j("",!0):(N(),Y(c,{key:0,type:"primary",size:"small",class:"flex",onClick:n[0]||(n[0]=e=>p("add"))},{default:s(()=>[n[1]||(n[1]=y("div",null,"Send Offer",-1)),o(v,{icon:"vuesax-linear:sms",Size:"16px"})]),_:1}))]),action:s(({column:e,record:a})=>n[2]||(n[2]=[])),_:1},16,["onRegister"])]),_:1})])}}}),se=[{title:"Rows",dataIndex:"id",key:"id",filterable:!1,sortable:!1,width:70,customRender:l=>l.index+1},{title:"Owner Name",dataIndex:"owner_name_formatted",key:"owner_name_formatted",type:"Text",width:140},{title:"Phone number",dataIndex:"phone_number",key:"phone_number",type:"Number",width:120,customRender(l){var t;return"+"+((t=l.record)==null?void 0:t.phone_number)}},{title:"Current LTV",dataIndex:"current_ltv",key:"current_ltv",type:"Number",width:90,customRender(l){var t;return((t=l.record)==null?void 0:t.current_ltv)??"- %"}},{title:"1st Mortgage Interest Rate",dataIndex:"first_mortgage_interest_rate",key:"first_mortgage_interest_rate",type:"Number",width:120,customRender(l){var t;return((t=l.record)==null?void 0:t.first_mortgage_interest_rate)??"- %"}},{title:"Age",dataIndex:"age",key:"age",type:"Number",width:60},{title:"1st Mortgage Loan Amount",dataIndex:"first_mortgage_loan_amount",key:"first_mortgage_loan_amount",type:"Number",width:120,customRender(l){var t;return E(((t=l.record)==null?void 0:t.first_mortgage_loan_amount)??0)}},{title:"2nd Mortgage Loan Amount",dataIndex:"second_mortgage_loan_amount",key:"second_mortgage_loan_amount",type:"Number",width:130,customRender(l){var t;return E(((t=l.record)==null?void 0:t.second_mortgage_loan_amount)??0)}},{title:"Current Year Tax Amount",dataIndex:"current_year_tax_amount",key:"current_year_tax_amount",type:"Number",width:120},{title:"Owner Occupied",dataIndex:"owner_occupied_residential",key:"owner_occupied_residential",type:"Boolean",width:100,customRender(l){var t;return(t=l.record)!=null&&t.owner_occupied_residential?"Yes":"No"}},{title:"Sale Recording Date",dataIndex:"sale_recording_date",key:"sale_recording_date",type:"Number",width:130}],re={class:"gap-2 hidden md:flex justify-center"},ue=S({__name:"customersTable",emits:["delete","edit","add","info","chargeMoney","update:items"],setup(l,{expose:t,emit:x}){const[f,g]=L(),p=x,h=[{value:"Current LTV Above 50",key:"current_ltv_above_50"},{value:"SR Date Above And FMLA",key:"sr_date_above_and_fmla"},{value:"Owner Occupied Residential No",key:"owner_occupied_residential_no"},{value:"Current Tax Year Above 20000",key:"current_tax_year_above20000"},{value:"FMLA Above 1 And SMLA Above 1",key:"fmla_above1_and_smla_above1"},{value:"Age Above 55",key:"age_above_55"},{value:"First Mortgage Interest Rate Above 65",key:"first_mortgage_interest_rate_above_65"},{value:"Current LTV Above 80",key:"current_ltv_above_80"},{value:"Complete Profile",key:"complete_profile"}];i(null);const r=i([]);function m(e){W("user",e.user_id,Z,g)}const n=i([]),v=i(void 0);let c=!1;const R=i({columns:se,api:async e=>{var u,w;c&&(e.filters=[],r.value.forEach(d=>{var k;(k=e.filters)==null||k.push({field:d,type:"switch",value:!0,cr:"and",op:"eq",hidden:!0})})),e.filters||(e.filters=[]),c=!1;const a=$.isEqual(e==null?void 0:e.filters,(u=v.value)==null?void 0:u.filters),_=$.isEqual(e==null?void 0:e.search,(w=v.value)==null?void 0:w.search);return(!a||!_)&&(n.value=[]),v.value=e,await q(e,"borrowers")},rowSelection:{selectedRowKeys:n,onSelect:(e,a,_,u)=>{n.value.includes(e.id)?n.value.splice(n.value.indexOf(e.id),1):n.value.push(e.id),p("items",n.value)},onSelectAll:(e,a,_)=>{e?n.value.push(...a.filter(u=>u==null?void 0:u.id).map(u=>u.id)):_.map(u=>{n.value.includes(u.id)&&n.value.splice(n.value.indexOf(u.id),1)}),p("update:items",n.value)}}});i(),i(!1);const C=()=>{g()};return D(r,e=>{c=!0,g()}),t({fetch:C}),(e,a)=>{const _=V,u=H,w=F;return N(),B("div",null,[o(w,O(R.value,{onRegister:b(f),ref:"tbl",height:"30vh"}),{extraHeader:s(()=>[o(_,{label:"Select condition",class:"w-30rem"},{default:s(()=>[o(P,{value:r.value,"onUpdate:value":a[0]||(a[0]=d=>r.value=d),items:h,valueName:"value","show-search":!1,keyName:"key",mode:"multiple",class:"w-full"},null,8,["value"])]),_:1})]),action:s(({column:d,record:k})=>[y("div",re,[o(u,{placement:"bottom",class:"cursor-pointer",onClick:T=>p("info",k)},{title:s(()=>a[1]||(a[1]=[y("span",null,"Details",-1)])),default:s(()=>[o(A,{icon:"vuesax-linear:stickynote",color:"#10913A"})]),_:2},1032,["onClick"]),o(u,{placement:"bottom",class:"cursor-pointer",onClick:T=>p("edit",k)},{title:s(()=>a[2]||(a[2]=[y("span",null,"Edit",-1)])),default:s(()=>[o(A,{icon:"vuesax-linear:edit",color:"#4572E9"})]),_:2},1032,["onClick"]),o(u,{placement:"bottom",class:"cursor-pointer",onClick:T=>m(k)},{title:s(()=>a[3]||(a[3]=[y("span",null,"Delete",-1)])),default:s(()=>[o(A,{icon:"vuesax-linear:trash",color:"#EB3535"})]),_:2},1032,["onClick"])])]),_:1},16,["onRegister"])])}}}),ie={class:"flex w-full h-full"},ke=S({__name:"index",setup(l){const t=i(!1),x=["Email","SMS"],f=i(null),g=i(null),p=()=>{var e;return(e=f==null?void 0:f.value)==null?void 0:e.fetch()};i(1);let h=i(0);const r=i({borrower_ids:[],message:"",type_offer:void 0,send_username_login:!1}),m=i();D(r.value.borrower_ids,e=>{console.log(e)});async function n(){t.value=!0,c.value=!0,h.value++,v(),t.value=!1}const v=()=>{var e;(e=m.value)==null||e.resetFields(),r.value={borrower_ids:[],message:"",type_offer:void 0,send_username_login:!1}},c=i(!1);function R(e){r.value.borrower_ids=e,console.log(r.value.borrower_ids)}function C(){var e;(e=m.value)==null||e.validateFields().then(async()=>{try{if(t.value=!0,r.value.borrower_ids===[]){M.error("Please select at least one user");return}await oe(r.value),v(),p(),c.value=!1,M.success("Request send successfully.")}catch(a){console.log(a)}finally{t.value=!1}})}return(e,a)=>{const _=V,u=Q,w=ee;return N(),B(J,null,[y("div",null,[o(te,null,{default:s(()=>[y("div",ie,[o(ne,{ref_key:"table",ref:f,class:"w-full h-full",onAdd:n},null,512)])]),_:1})]),o(K,{visible:c.value,"onUpdate:visible":a[3]||(a[3]=d=>c.value=d),width:"90vw",title:"",onOk:C,loading:t.value,onClose:a[4]||(a[4]=d=>c.value=!1)},{default:s(()=>[o(w,{model:r.value,ref_key:"formRef",ref:m,autocomplete:"off",class:"md:grid md:grid-cols-4 gap-4"},{default:s(()=>[o(_,{label:"Select send type",name:"type_offer",rules:b(I)()},{default:s(()=>[o(P,{value:r.value.type_offer,"onUpdate:value":a[0]||(a[0]=d=>r.value.type_offer=d),items:x,valueName:"",keyName:"",class:"w-full",onChange:e.getGroupNumbers},null,8,["value","onChange"])]),_:1},8,["rules"]),o(_,{label:"Send user information",name:"send_username_login",rules:b(I)()},{default:s(()=>[o(u,{checked:r.value.send_username_login,"onUpdate:checked":a[1]||(a[1]=d=>r.value.send_username_login=d)},null,8,["checked"])]),_:1},8,["rules"]),o(_,{label:"Message",name:"message",class:"md:col-span-4",rules:b(I)()},{default:s(()=>[o(ae,{value:r.value.message,"onUpdate:value":a[2]||(a[2]=d=>r.value.message=d)},null,8,["value"])]),_:1},8,["rules"]),o(_,{label:"Select user(s)",class:"md:col-span-4",rules:b(I)()},{default:s(()=>[o(ue,{ref_key:"tableCustomer",ref:g,class:"w-full h-full",onItems:R},null,512)]),_:1},8,["rules"])]),_:1},8,["model"])]),_:1},8,["visible","loading"])],64)}}});export{ke as default};
