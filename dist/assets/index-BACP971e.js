import{d as N,b as l,ak as O,j as k,o as h,aa as R,p as a,w as o,a as r,a7 as y,ay as S,u as p,am as x,c as H,az as C,a5 as W,a6 as Y,aw as J,a9 as K,z as L,aA as Q,aB as X,aq as Z,k as ee}from"./index-C59nPxhS.js";import{_ as te}from"./UserField.vue_vue_type_script_setup_true_lang-CQM04a8h.js";import{T as le,u as se,b as ae}from"./confirmModal-BHHX47cc.js";import{r as oe}from"./useDataTime-Bw-ruvr2.js";import{C as ne,g as ie,s as re,c as ue}from"./chat-CUTFs76Z.js";import{B as de}from"./BasicMainCard-DYu65gub.js";import"./index-hdx7AmHB.js";import"./Col-BSSjyXRi.js";import"./useSize-Bw3G1olW.js";import"./BasicTextArea.vue_vue_type_style_index_0_lang-DaM2e8TG.js";const fe=[{title:"Rows",dataIndex:"id",key:"id",filterable:!1,sortable:!1,width:100,customRender:n=>n.index+1},{title:"Owner Name",dataIndex:"borrowers.owner_name_formatted",key:"borrowers.owner_name_formatted",type:"Text",width:140},{title:"Date and time",dataIndex:"created_at",key:"created_at",type:"DateTime",width:130,customRender(n){return oe(n.record.created_at)}},{title:"Pricing(%)",dataIndex:"pricing_details",key:"pricing_details",type:"Number",width:140,customRender(n){return n.record.pricing_details??"_"}},{title:"income($)",dataIndex:"income",key:"income",type:"Number",width:140,customRender(n){return n.record.income??"_"}},{title:"Call request",dataIndex:"call_request",key:"call_request",type:"Boolean",width:140,customRender(n){return n.record.call_request?"Yes":"No"}},{title:"options",dataIndex:"action",key:"action",slot:"action",fixed:"right",width:120,filterable:!1}],me={class:"gap-8 flex justify-center"},ce={class:"flex justify-between text-lg"},pe={class:"font-bold"},_e=N({__name:"table",props:{mobile:{}},emits:["delete","edit","add","info"],setup(n,{expose:m,emit:B}){const[_,u]=se(),f=l([]),d=l(),c=l(),V=O(),I=l(""),v=l();async function P(t){var e;I.value=(e=(await ie(t)).data[0])==null?void 0:e.id,await re(t),u(),d.value=!0}function D(t){ae("Are you sure to finish call?",t??"",ue,M)}function M(){c.value=!1,u()}async function U(t){v.value=t,c.value=!0}l(null);const $=l(),b=l(!1),j=l({columns:fe,api:t=>{var e;return t.filters||(t.filters=[]),(e=t.filters)==null||e.push({field:"status",type:"text",value:"accepted",cr:"and",op:"eq",hidden:!0}),t.select=["*","borrowers (*)"],le(t,"pricing_requests")}}),A=()=>{u()};function E(t){console.log(t),$.value=K.cloneDeep(t),b.value=!0}return k(f,t=>{u()}),m({fetch:A}),k(()=>V.refreshTable,t=>{console.log("nemidanam triggered. New refreshTable value:",t),u()}),(t,e)=>{const g=L,T=Q,F=X,z=te,G=Z;return h(),R("div",null,[a(F,S(j.value,{onRegister:p(_),ref:"tbl"}),{extraHeader:o(()=>e[6]||(e[6]=[])),action:o(({column:i,record:s})=>[r("div",me,[a(g,{placement:"bottom",class:"cursor-pointer",onClick:w=>E(s==null?void 0:s.borrowers)},{title:o(()=>e[7]||(e[7]=[r("span",null,"Info",-1)])),default:o(()=>[a(y,{icon:"vuesax-linear:personalcard",color:"blue"})]),_:2},1032,["onClick"]),a(g,{placement:"bottom",class:"cursor-pointer",onClick:w=>U(s)},{title:o(()=>e[8]||(e[8]=[r("span",null,"Call",-1)])),default:o(()=>[a(T,{dot:s==null?void 0:s.call_request},{default:o(()=>[a(y,{icon:"vuesax-linear:call",color:"green"})]),_:2},1032,["dot"])]),_:2},1032,["onClick"]),a(g,{placement:"bottom",class:"cursor-pointer",onClick:w=>P(s==null?void 0:s.id)},{title:o(()=>e[9]||(e[9]=[r("span",null,"Chat",-1)])),default:o(()=>[a(T,{dot:s==null?void 0:s.new_message},{default:o(()=>[a(y,{icon:"vuesax-linear:message",color:"orange"})]),_:2},1032,["dot"])]),_:2},1032,["onClick"])])]),_:1},16,["onRegister"]),a(x,{visible:b.value,width:"70rem",height:"90rem",title:"Borrower details","custom-footer":!0,onClose:e[0]||(e[0]=i=>b.value=!1),destroyOnClose:!0},{default:o(()=>[a(z,{"user-form":$.value},null,8,["user-form"])]),_:1},8,["visible"]),a(x,{visible:d.value,"onUpdate:visible":e[1]||(e[1]=i=>d.value=i),width:"30rem",title:"Messages","custom-footer":"",loading:p(C),onClose:e[2]||(e[2]=i=>d.value=!1)},{default:o(()=>[d.value?(h(),H(ne,{key:0,id:I.value,loading:p(C)},null,8,["id","loading"])):W("",!0)]),_:1},8,["visible","loading"]),a(x,{visible:c.value,"onUpdate:visible":e[4]||(e[4]=i=>c.value=i),width:"20rem",title:"Phone","custom-footer":"",loading:p(C),onClose:e[5]||(e[5]=i=>d.value=!1)},{default:o(()=>{var i,s;return[r("div",ce,[e[10]||(e[10]=r("div",null,"Phone:",-1)),r("div",pe,Y((s=(i=v.value)==null?void 0:i.borrowers)==null?void 0:s.phone_number),1)]),a(G,{class:"mt-5 w-full",type:"primary",onClick:e[3]||(e[3]=w=>{var q;return D((q=v.value)==null?void 0:q.id)})},{default:o(()=>e[11]||(e[11]=[J("I have been called ")])),_:1})]}),_:1},8,["visible","loading"])])}}}),ve={class:"flex w-full h-full"},$e=N({__name:"index",setup(n){const m=l(!1);l([]),ee(()=>B());async function B(){try{m.value=!0}catch(f){console.log(f)}finally{m.value=!1}}const _=l(null);l(null),l(0);const u=l({borrower_ids:[],message:"",type_offer:void 0,send_username_login:!1});return l(),k(u.value.borrower_ids,f=>{console.log(f)}),l(!1),(f,d)=>(h(),R("div",null,[a(de,null,{default:o(()=>[r("div",ve,[a(_e,{ref_key:"table",ref:_,class:"w-full h-full"},null,512)])]),_:1})]))}});export{$e as default};
