import{T as S,u as H,b as W}from"./confirmModal-BWq_k7U9.js";import{d as q,b as l,aj as Y,j as h,r as y,o as B,a9 as V,p as a,w as o,a as r,ak as x,ax as J,u as p,am as C,c as K,ay as k,a5 as L,a6 as Q,av as X,a8 as Z,z as ee,az as te,k as le}from"./index-CfWkRTX1.js";import{r as se}from"./useDataTime-DOvR3mNh.js";import{C as ae,g as oe,s as ne,c as ie}from"./chat-Mrt2BF4M.js";import{B as re}from"./BasicMainCard-bc3pVwCj.js";import"./axios-m3d4XWHp.js";import"./BasicTextArea.vue_vue_type_style_index_0_lang-BXTOc1vX.js";import"./Col-287scPdA.js";const ue=[{title:"Rows",dataIndex:"id",key:"id",filterable:!1,sortable:!1,width:100,customRender:n=>n.index+1},{title:"Owner Name",dataIndex:"borrowers.owner_name_formatted",key:"borrowers.owner_name_formatted",type:"Text",width:140},{title:"Date and time",dataIndex:"created_at",key:"created_at",type:"DateTime",width:130,customRender(n){return se(n.record.created_at)}},{title:"Pricing(%)",dataIndex:"pricing_details",key:"pricing_details",type:"Number",width:140,customRender(n){return n.record.pricing_details??"_"}},{title:"income($)",dataIndex:"income",key:"income",type:"Number",width:140,customRender(n){return n.record.income??"_"}},{title:"Call request",dataIndex:"call_request",key:"call_request",type:"Boolean",width:140,customRender(n){return n.record.call_request?"Yes":"No"}},{title:"options",dataIndex:"action",key:"action",slot:"action",fixed:"right",width:120,filterable:!1}],de={class:"gap-8 flex justify-center"},fe={class:"flex justify-between text-lg"},ce={class:"font-bold"},me=q({__name:"table",props:{mobile:{}},emits:["delete","edit","add","info"],setup(n,{expose:c,emit:I}){const[_,u]=H(),f=l([]),d=l(),m=l(),P=Y(),T=l(""),v=l();async function D(t){var e;T.value=(e=(await oe(t)).data[0])==null?void 0:e.id,await ne(t),u(),d.value=!0}function U(t){W("Are you sure to finish call?",t??"",ie,j)}function j(){m.value=!1,u()}async function F(t){v.value=t,m.value=!0}l(null);const $=l(),b=l(!1),M=l({columns:ue,api:t=>{var e;return t.filters||(t.filters=[]),(e=t.filters)==null||e.push({field:"status",type:"text",value:"accepted",cr:"and",op:"eq",hidden:!0}),t.select=["*","borrowers (*)"],S(t,"pricing_requests")}}),E=()=>{u()};function z(t){console.log(t),$.value=Z.cloneDeep(t),b.value=!0}return h(f,t=>{u()}),c({fetch:E}),h(()=>P.refreshTable,t=>{console.log("nemidanam triggered. New refreshTable value:",t),u()}),(t,e)=>{const g=ee,N=te,A=y("BaseTable"),G=y("UserField"),O=y("BaseButton");return B(),V("div",null,[a(A,J(M.value,{onRegister:p(_),ref:"tbl"}),{extraHeader:o(()=>e[6]||(e[6]=[])),action:o(({column:i,record:s})=>[r("div",de,[a(g,{placement:"bottom",class:"cursor-pointer",onClick:w=>z(s==null?void 0:s.borrowers)},{title:o(()=>e[7]||(e[7]=[r("span",null,"Info",-1)])),default:o(()=>[a(x,{icon:"vuesax-linear:personalcard",color:"blue"})]),_:2},1032,["onClick"]),a(g,{placement:"bottom",class:"cursor-pointer",onClick:w=>F(s)},{title:o(()=>e[8]||(e[8]=[r("span",null,"Call",-1)])),default:o(()=>[a(N,{dot:s==null?void 0:s.call_request},{default:o(()=>[a(x,{icon:"vuesax-linear:call",color:"green"})]),_:2},1032,["dot"])]),_:2},1032,["onClick"]),a(g,{placement:"bottom",class:"cursor-pointer",onClick:w=>D(s==null?void 0:s.id)},{title:o(()=>e[9]||(e[9]=[r("span",null,"Chat",-1)])),default:o(()=>[a(N,{dot:s==null?void 0:s.new_message},{default:o(()=>[a(x,{icon:"vuesax-linear:message",color:"orange"})]),_:2},1032,["dot"])]),_:2},1032,["onClick"])])]),_:1},16,["onRegister"]),a(C,{visible:b.value,width:"70rem",height:"90rem",title:"Borrower details","custom-footer":!0,onClose:e[0]||(e[0]=i=>b.value=!1),destroyOnClose:!0},{default:o(()=>[a(G,{"user-form":$.value},null,8,["user-form"])]),_:1},8,["visible"]),a(C,{visible:d.value,"onUpdate:visible":e[1]||(e[1]=i=>d.value=i),width:"30rem",title:"Messages","custom-footer":"",loading:p(k),onClose:e[2]||(e[2]=i=>d.value=!1)},{default:o(()=>[d.value?(B(),K(ae,{key:0,id:T.value,loading:p(k)},null,8,["id","loading"])):L("",!0)]),_:1},8,["visible","loading"]),a(C,{visible:m.value,"onUpdate:visible":e[4]||(e[4]=i=>m.value=i),width:"20rem",title:"Phone","custom-footer":"",loading:p(k),onClose:e[5]||(e[5]=i=>d.value=!1)},{default:o(()=>{var i,s;return[r("div",fe,[e[10]||(e[10]=r("div",null,"Phone:",-1)),r("div",ce,Q((s=(i=v.value)==null?void 0:i.borrowers)==null?void 0:s.phone_number),1)]),a(O,{class:"mt-5 w-full",type:"primary",onClick:e[3]||(e[3]=w=>{var R;return U((R=v.value)==null?void 0:R.id)})},{default:o(()=>e[11]||(e[11]=[X("I have been called ")])),_:1})]}),_:1},8,["visible","loading"])])}}}),pe={class:"flex w-full h-full"},ke=q({__name:"index",setup(n){const c=l(!1);l([]),le(()=>I());async function I(){try{c.value=!0}catch(f){console.log(f)}finally{c.value=!1}}const _=l(null);l(null),l(0);const u=l({borrower_ids:[],message:"",type_offer:void 0,send_username_login:!1});return l(),h(u.value.borrower_ids,f=>{console.log(f)}),l(!1),(f,d)=>(B(),V("div",null,[a(re,null,{default:o(()=>[r("div",pe,[a(me,{ref_key:"table",ref:_,class:"w-full h-full"},null,512)])]),_:1})]))}});export{ke as default};
